{"ast":null,"code":"import _objectSpread from\"/app/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect}from\"react\";import\"./App.css\";import axios from\"axios\";// ---------- API エンドポイント生成 ----------\nimport{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const BACKEND_URL=(process.env.REACT_APP_BACKEND_URL||\"\").replace(/\\/+$/,\"\");const API=\"\".concat(BACKEND_URL?BACKEND_URL:\"\",\"/api\");const api=axios.create({baseURL:API});const App=()=>{const[reservations,setReservations]=useState([]);const[selectedDate,setSelectedDate]=useState(new Date().toISOString().split('T')[0]);const[showCreateForm,setShowCreateForm]=useState(false);const[editingReservation,setEditingReservation]=useState(null);const[loading,setLoading]=useState(false);const[error,setError]=useState('');// Form state\nconst[formData,setFormData]=useState({bench_id:'front',user_name:'',start_time:'',end_time:''});// Load reservations for selected date with comprehensive error handling\nconst loadReservations=async function(){let retryCount=arguments.length>0&&arguments[0]!==undefined?arguments[0]:0;let maxRetries=arguments.length>1&&arguments[1]!==undefined?arguments[1]:3;try{console.log(\"\\u4E88\\u7D04\\u8AAD\\u307F\\u8FBC\\u307F\\u958B\\u59CB (\\u8A66\\u884C \".concat(retryCount+1,\"/\").concat(maxRetries+1,\"):\"),selectedDate);setLoading(true);setError('');// エラーをクリア\n// リクエスト設定の最適化\nconst requestConfig={params:{date:selectedDate},timeout:8000+retryCount*2000,// 段階的にタイムアウトを延長\nvalidateStatus:function(status){return status>=200&&status<300;// デフォルト\n},headers:{'Accept':'application/json','Content-Type':'application/json'}};const response=await axios.get(\"\".concat(API,\"/reservations\"),requestConfig);// レスポンスデータの検証\nif(!Array.isArray(response.data)){throw new Error('サーバーから無効なデータ形式が返されました');}// データの妥当性チェック\nconst validReservations=response.data.filter(reservation=>{return reservation&&reservation.id&&reservation.bench_id&&reservation.user_name&&reservation.start_time&&reservation.end_time;});if(validReservations.length!==response.data.length){console.warn(\"\\u7121\\u52B9\\u306A\\u4E88\\u7D04\\u30C7\\u30FC\\u30BF\\u3092\\u9664\\u5916: \".concat(response.data.length-validReservations.length,\"\\u4EF6\"));}console.log('予約データ取得成功:',validReservations);setReservations(validReservations);}catch(err){console.error(\"\\u4E88\\u7D04\\u8AAD\\u307F\\u8FBC\\u307F\\u30A8\\u30E9\\u30FC (\\u8A66\\u884C \".concat(retryCount+1,\"):\"),err);// エラー分類と自動リトライ判定\nconst isRetryableError=err.code==='ECONNABORTED'||// タイムアウト\nerr.code==='NETWORK_ERROR'||// ネットワークエラー\nerr.code==='ERR_NETWORK'||// ネットワークエラー (axios)\nerr.response&&err.response.status>=500||// サーバーエラー\nerr.response&&err.response.status===503||// サービス利用不可\nerr.response&&err.response.status===504// タイムアウト\n;const shouldRetry=retryCount<maxRetries&&isRetryableError;if(shouldRetry){const delay=Math.min(1000*2**retryCount,8000);// 最大8秒\nconsole.log(\"\".concat(delay/1000,\"\\u79D2\\u5F8C\\u306B\\u81EA\\u52D5\\u30EA\\u30C8\\u30E9\\u30A4\\u3057\\u307E\\u3059...\"));setError(\"\\u63A5\\u7D9A\\u4E2D\\u3067\\u3059... (\".concat(retryCount+1,\"\\u56DE\\u76EE\\u518D\\u8A66\\u884C\\u4E2D)\"));setTimeout(()=>{loadReservations(retryCount+1,maxRetries);},delay);}else{// 最大リトライ回数に達した場合またはリトライ不可エラー\nlet errorMessage='予約の読み込みに失敗しました';if(err.response){var _err$response$data;// サーバーエラーレスポンスがある場合\nerrorMessage=((_err$response$data=err.response.data)===null||_err$response$data===void 0?void 0:_err$response$data.detail)||\"\\u30B5\\u30FC\\u30D0\\u30FC\\u30A8\\u30E9\\u30FC (\".concat(err.response.status,\")\");}else if(err.code==='ECONNABORTED'||err.code==='ERR_NETWORK'){errorMessage='ネットワーク接続に問題があります';}else if(err.message){errorMessage=err.message;}setError(errorMessage);console.error('最大リトライ回数に達しました:',err);}}finally{setLoading(false);}};useEffect(()=>{loadReservations();},[selectedDate]);// Create reservation\nconst createReservation=async e=>{e.preventDefault();try{setLoading(true);setError('');const reservationData=_objectSpread(_objectSpread({},formData),{},{start_time:\"\".concat(selectedDate,\"T\").concat(formData.start_time,\":00\"),end_time:\"\".concat(selectedDate,\"T\").concat(formData.end_time,\":00\")});await axios.post(\"\".concat(API,\"/reservations\"),reservationData);// Reset form and refresh\nsetFormData({bench_id:'front',user_name:'',start_time:'',end_time:''});setShowCreateForm(false);await loadReservations();}catch(err){var _err$response,_err$response$data2;setError(((_err$response=err.response)===null||_err$response===void 0?void 0:(_err$response$data2=_err$response.data)===null||_err$response$data2===void 0?void 0:_err$response$data2.detail)||'予約の作成に失敗しました');}finally{setLoading(false);}};// Update reservation\nconst updateReservation=async e=>{e.preventDefault();try{setLoading(true);setError('');const updateData={user_name:formData.user_name,start_time:\"\".concat(selectedDate,\"T\").concat(formData.start_time,\":00\"),end_time:\"\".concat(selectedDate,\"T\").concat(formData.end_time,\":00\")};await axios.put(\"\".concat(API,\"/reservations/\").concat(editingReservation.id),updateData);// Reset form and refresh\nsetFormData({bench_id:'front',user_name:'',start_time:'',end_time:''});setEditingReservation(null);await loadReservations();}catch(err){var _err$response2,_err$response2$data;setError(((_err$response2=err.response)===null||_err$response2===void 0?void 0:(_err$response2$data=_err$response2.data)===null||_err$response2$data===void 0?void 0:_err$response2$data.detail)||'予約の更新に失敗しました');}finally{setLoading(false);}};// Start editing\nconst startEdit=reservation=>{const startTime=new Date(reservation.start_time).toTimeString().substring(0,5);const endTime=new Date(reservation.end_time).toTimeString().substring(0,5);setFormData({bench_id:reservation.bench_id,user_name:reservation.user_name,start_time:startTime,end_time:endTime});setEditingReservation(reservation);setShowCreateForm(false);};// Date navigation\nconst changeDate=days=>{const newDate=new Date(selectedDate);newDate.setDate(newDate.getDate()+days);setSelectedDate(newDate.toISOString().split('T')[0]);};// Format date for display\nconst formatDate=dateString=>{const date=new Date(dateString);return date.toLocaleDateString('ja-JP',{year:'numeric',month:'long',day:'numeric',weekday:'long'});};// Generate time slots for timetable (every 30 minutes, 7:00-22:00)\nconst generateTimeSlots=()=>{const slots=[];for(let hour=7;hour<=22;hour++){for(let minute=0;minute<60;minute+=30){const timeString=\"\".concat(hour.toString().padStart(2,'0'),\":\").concat(minute.toString().padStart(2,'0'));slots.push(timeString);}}return slots;};// Calculate reservation bar properties\nconst calculateBarProperties=reservation=>{const startDate=new Date(reservation.start_time);const endDate=new Date(reservation.end_time);const startMinutes=startDate.getHours()*60+startDate.getMinutes();const endMinutes=endDate.getHours()*60+endDate.getMinutes();const durationMinutes=endMinutes-startMinutes;// 7:00 (420分) を基準点として調整\nconst baseOffsetMinutes=7*60;// 7:00 = 420分\nconst adjustedStartMinutes=startMinutes-baseOffsetMinutes;// Each 30-minute slot is 40px high\nconst pixelsPerMinute=40/30;const top=adjustedStartMinutes*pixelsPerMinute;const height=durationMinutes*pixelsPerMinute;return{top,height};};// Get reservation color\nconst getReservationColor=index=>{const colors=['#667eea','#764ba2','#f093fb','#f5576c','#4facfe','#00f2fe','#43e97b','#38f9d7','#ffecd2','#fcb69f','#a8edea','#fed6e3'];return colors[index%colors.length];};// Auto cleanup old data function\nconst cleanupOldData=async()=>{try{setLoading(true);setError('');const response=await axios.post(\"\".concat(API,\"/cleanup/old-data\"),{},{timeout:15000// 15秒タイムアウト\n});console.log('クリーンアップ完了:',response.data);// 成功メッセージを表示\nif(response.data.deleted_count>0){alert(\"\\u2705 \".concat(response.data.deleted_count,\"\\u4EF6\\u306E\\u53E4\\u3044\\u4E88\\u7D04\\u30C7\\u30FC\\u30BF\\u3092\\u524A\\u9664\\u3057\\u307E\\u3057\\u305F\"));}else{alert('ℹ️ 削除対象のデータはありませんでした');}// 予約リストを更新\nawait loadReservations();}catch(err){var _err$response3,_err$response3$data;console.error('クリーンアップエラー:',err);const errorMessage=((_err$response3=err.response)===null||_err$response3===void 0?void 0:(_err$response3$data=_err$response3.data)===null||_err$response3$data===void 0?void 0:_err$response3$data.detail)||'データクリーンアップに失敗しました';setError(\"\\u30AF\\u30EA\\u30FC\\u30F3\\u30A2\\u30C3\\u30D7\\u30A8\\u30E9\\u30FC: \".concat(errorMessage));}finally{setLoading(false);}};const timeSlots=generateTimeSlots();return/*#__PURE__*/_jsx(\"div\",{className:\"app\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"container\",children:[/*#__PURE__*/_jsxs(\"header\",{className:\"header\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"\\u30AF\\u30EA\\u30FC\\u30F3\\u30D9\\u30F3\\u30C1\\u4E88\\u7D04\\u30B7\\u30B9\\u30C6\\u30E0\"}),/*#__PURE__*/_jsx(\"p\",{className:\"version-info\",children:\"\\u30D0\\u30FC\\u30B8\\u30E7\\u30F3 2.0 - \\u6539\\u5584\\u7248\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"date-navigation\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>changeDate(-1),className:\"nav-button\",children:\"\\u2190 \\u524D\\u65E5\"}),/*#__PURE__*/_jsx(\"div\",{className:\"current-date\",children:formatDate(selectedDate)}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>changeDate(1),className:\"nav-button\",children:\"\\u7FCC\\u65E5 \\u2192\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"action-buttons\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>{setShowCreateForm(true);setEditingReservation(null);setFormData({bench_id:'front',user_name:'',start_time:'',end_time:''});},className:\"create-button\",children:\"\\u65B0\\u898F\\u4E88\\u7D04\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>{console.log('手動更新ボタンがクリックされました');loadReservations(0,3);// 手動更新時も自動リトライ機能を使用\n},className:\"refresh-button\",disabled:loading,title:\"\\u4E88\\u7D04\\u4E00\\u89A7\\u3092\\u624B\\u52D5\\u3067\\u66F4\\u65B0\",children:loading?'🔄 更新中...':'🔄 更新'}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>{if(window.confirm('30日より古い予約データを削除します。\\nこの操作は取り消せません。\\n実行しますか？')){cleanupOldData();}},className:\"cleanup-button\",disabled:loading,title:\"30\\u65E5\\u3088\\u308A\\u53E4\\u3044\\u4E88\\u7D04\\u30C7\\u30FC\\u30BF\\u3092\\u524A\\u9664\\u3057\\u3066\\u30C7\\u30FC\\u30BF\\u30D9\\u30FC\\u30B9\\u5BB9\\u91CF\\u3092\\u7BC0\\u7D04\",children:loading?'🧹 削除中...':'🧹 古いデータ削除'})]}),error&&/*#__PURE__*/_jsxs(\"div\",{className:\"error-container\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"error-message\",children:[\"\\u26A0\\uFE0F \",error]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>{setError('');loadReservations(0,3);},className:\"retry-button\",disabled:loading,children:loading?'再試行中...':'🔄 再試行'})]}),(showCreateForm||editingReservation)&&/*#__PURE__*/_jsxs(\"div\",{className:\"form-container\",children:[/*#__PURE__*/_jsx(\"h3\",{children:editingReservation?'予約編集':'新規予約'}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:editingReservation?updateReservation:createReservation,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"\\u30D9\\u30F3\\u30C1:\"}),/*#__PURE__*/_jsxs(\"select\",{value:formData.bench_id,onChange:e=>setFormData(_objectSpread(_objectSpread({},formData),{},{bench_id:e.target.value})),disabled:!!editingReservation,children:[/*#__PURE__*/_jsx(\"option\",{value:\"front\",children:\"\\u624B\\u524D\"}),/*#__PURE__*/_jsx(\"option\",{value:\"back\",children:\"\\u5965\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"\\u5229\\u7528\\u8005\\u540D:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:formData.user_name,onChange:e=>setFormData(_objectSpread(_objectSpread({},formData),{},{user_name:e.target.value})),required:true,placeholder:\"\\u304A\\u540D\\u524D\\u3092\\u5165\\u529B\\u3057\\u3066\\u304F\\u3060\\u3055\\u3044\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"\\u958B\\u59CB\\u6642\\u523B:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"time\",value:formData.start_time,onChange:e=>setFormData(_objectSpread(_objectSpread({},formData),{},{start_time:e.target.value})),min:\"07:00\",max:\"22:00\",step:\"1800\",required:true}),/*#__PURE__*/_jsx(\"small\",{style:{color:'#666',fontSize:'0.8rem'},children:\"\\u5229\\u7528\\u53EF\\u80FD\\u6642\\u9593: 7:00-22:00 (30\\u5206\\u523B\\u307F)\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"\\u7D42\\u4E86\\u6642\\u523B:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"time\",value:formData.end_time,onChange:e=>setFormData(_objectSpread(_objectSpread({},formData),{},{end_time:e.target.value})),min:\"07:00\",max:\"22:00\",step:\"1800\",required:true}),/*#__PURE__*/_jsx(\"small\",{style:{color:'#666',fontSize:'0.8rem'},children:\"\\u5229\\u7528\\u53EF\\u80FD\\u6642\\u9593: 7:00-22:00 (30\\u5206\\u523B\\u307F)\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-buttons\",children:[/*#__PURE__*/_jsx(\"button\",{type:\"submit\",disabled:loading,children:editingReservation?'更新':'予約作成'}),editingReservation&&/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"delete-form-button\",disabled:loading,onClick:()=>{console.log('削除ボタンがクリックされました');console.log('編集中の予約:',editingReservation);const handleDelete=async()=>{try{// 詳細な確認ダイアログ\nconst userConfirmed=window.confirm(\"\\u26A0\\uFE0F \\u4E88\\u7D04\\u3092\\u524A\\u9664\\u3057\\u3066\\u3082\\u3088\\u308D\\u3057\\u3044\\u3067\\u3059\\u304B\\uFF1F\\n\\n\"+\"\\uD83D\\uDCDD \\u5229\\u7528\\u8005: \".concat(editingReservation.user_name,\"\\n\")+\"\\u23F0 \\u6642\\u9593: \".concat(new Date(editingReservation.start_time).toTimeString().substring(0,5),\" - \").concat(new Date(editingReservation.end_time).toTimeString().substring(0,5),\"\\n\")+\"\\uD83C\\uDFE2 \\u30D9\\u30F3\\u30C1: \".concat(editingReservation.bench_id==='front'?'手前':'奥',\"\\n\\n\")+\"\\u274C \\u3053\\u306E\\u64CD\\u4F5C\\u306F\\u53D6\\u308A\\u6D88\\u305B\\u307E\\u305B\\u3093\\u3002\\n\\n\"+\"\\u524A\\u9664\\u3059\\u308B\\u5834\\u5408\\u306F\\u300COK\\u300D\\u3092\\u62BC\\u3057\\u3066\\u304F\\u3060\\u3055\\u3044\\u3002\");if(!userConfirmed){console.log('ユーザーが削除をキャンセルしました');return;}console.log('削除処理を開始します...');console.log('削除対象ID:',editingReservation.id);setLoading(true);setError('');// DELETE リクエスト送信\nconst response=await axios.delete(\"\".concat(API,\"/reservations/\").concat(editingReservation.id));console.log('✅ 削除成功:',response.data);// 状態をリセット\nsetEditingReservation(null);setFormData({bench_id:'front',user_name:'',start_time:'',end_time:''});// 予約リストを再読み込み\nawait loadReservations();console.log('✅ 削除処理が完了しました');}catch(error){var _error$response,_error$response$data;console.error('❌ 削除エラー:',error);if(error.response){console.error('レスポンスエラー:',error.response.data);console.error('ステータスコード:',error.response.status);}setError(\"\\u524A\\u9664\\u306B\\u5931\\u6557\\u3057\\u307E\\u3057\\u305F: \".concat(((_error$response=error.response)===null||_error$response===void 0?void 0:(_error$response$data=_error$response.data)===null||_error$response$data===void 0?void 0:_error$response$data.detail)||error.message));}finally{setLoading(false);}};handleDelete();},children:loading?'削除中...':'🗑️ 予約削除'}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:()=>{setShowCreateForm(false);setEditingReservation(null);setError('');},children:\"\\u30AD\\u30E3\\u30F3\\u30BB\\u30EB\"})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"timetable-container\",children:[loading&&/*#__PURE__*/_jsx(\"div\",{className:\"loading\",children:\"\\u8AAD\\u307F\\u8FBC\\u307F\\u4E2D...\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"timetable\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"timetable-header\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"time-column-header\",children:\"\\u6642\\u523B\"}),/*#__PURE__*/_jsx(\"div\",{className:\"bench-column-header\",children:\"\\u624B\\u524D\"}),/*#__PURE__*/_jsx(\"div\",{className:\"bench-column-header\",children:\"\\u5965\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"timetable-grid\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"time-column\",children:timeSlots.map((time,index)=>/*#__PURE__*/_jsx(\"div\",{className:\"time-slot\",children:time},time))}),/*#__PURE__*/_jsx(\"div\",{className:\"bench-column\",\"data-bench\":\"front\",children:/*#__PURE__*/_jsx(\"div\",{className:\"bench-timeline\",children:reservations.filter(r=>r.bench_id==='front').map((reservation,index)=>{const{top,height}=calculateBarProperties(reservation);return/*#__PURE__*/_jsxs(\"div\",{className:\"reservation-bar\",style:{top:\"\".concat(top,\"px\"),height:\"\".concat(height,\"px\"),backgroundColor:getReservationColor(index),left:'2px',right:'2px'},onClick:()=>startEdit(reservation),title:\"\\u30AF\\u30EA\\u30C3\\u30AF\\u3057\\u3066\\u7DE8\\u96C6: \".concat(reservation.user_name,\" (\").concat(new Date(reservation.start_time).toTimeString().substring(0,5),\" - \").concat(new Date(reservation.end_time).toTimeString().substring(0,5),\")\"),children:[/*#__PURE__*/_jsxs(\"div\",{className:\"reservation-content\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"reservation-user\",children:reservation.user_name}),/*#__PURE__*/_jsxs(\"div\",{className:\"reservation-time\",children:[new Date(reservation.start_time).toTimeString().substring(0,5),\" - \",new Date(reservation.end_time).toTimeString().substring(0,5)]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"edit-indicator\",children:\"\\u7DE8\\u96C6\"})]},reservation.id);})})}),/*#__PURE__*/_jsx(\"div\",{className:\"bench-column\",\"data-bench\":\"back\",children:/*#__PURE__*/_jsx(\"div\",{className:\"bench-timeline\",children:reservations.filter(r=>r.bench_id==='back').map((reservation,index)=>{const{top,height}=calculateBarProperties(reservation);return/*#__PURE__*/_jsxs(\"div\",{className:\"reservation-bar\",style:{top:\"\".concat(top,\"px\"),height:\"\".concat(height,\"px\"),backgroundColor:getReservationColor(index+6),left:'2px',right:'2px'},onClick:()=>startEdit(reservation),title:\"\\u30AF\\u30EA\\u30C3\\u30AF\\u3057\\u3066\\u7DE8\\u96C6: \".concat(reservation.user_name,\" (\").concat(new Date(reservation.start_time).toTimeString().substring(0,5),\" - \").concat(new Date(reservation.end_time).toTimeString().substring(0,5),\")\"),children:[/*#__PURE__*/_jsxs(\"div\",{className:\"reservation-content\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"reservation-user\",children:reservation.user_name}),/*#__PURE__*/_jsxs(\"div\",{className:\"reservation-time\",children:[new Date(reservation.start_time).toTimeString().substring(0,5),\" - \",new Date(reservation.end_time).toTimeString().substring(0,5)]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"edit-indicator\",children:\"\\u7DE8\\u96C6\"})]},reservation.id);})})})]})]})]})]})});};export default App;","map":{"version":3,"names":["React","useState","useEffect","axios","jsx","_jsx","jsxs","_jsxs","BACKEND_URL","process","env","REACT_APP_BACKEND_URL","replace","API","concat","api","create","baseURL","App","reservations","setReservations","selectedDate","setSelectedDate","Date","toISOString","split","showCreateForm","setShowCreateForm","editingReservation","setEditingReservation","loading","setLoading","error","setError","formData","setFormData","bench_id","user_name","start_time","end_time","loadReservations","retryCount","arguments","length","undefined","maxRetries","console","log","requestConfig","params","date","timeout","validateStatus","status","headers","response","get","Array","isArray","data","Error","validReservations","filter","reservation","id","warn","err","isRetryableError","code","shouldRetry","delay","Math","min","setTimeout","errorMessage","_err$response$data","detail","message","createReservation","e","preventDefault","reservationData","_objectSpread","post","_err$response","_err$response$data2","updateReservation","updateData","put","_err$response2","_err$response2$data","startEdit","startTime","toTimeString","substring","endTime","changeDate","days","newDate","setDate","getDate","formatDate","dateString","toLocaleDateString","year","month","day","weekday","generateTimeSlots","slots","hour","minute","timeString","toString","padStart","push","calculateBarProperties","startDate","endDate","startMinutes","getHours","getMinutes","endMinutes","durationMinutes","baseOffsetMinutes","adjustedStartMinutes","pixelsPerMinute","top","height","getReservationColor","index","colors","cleanupOldData","deleted_count","alert","_err$response3","_err$response3$data","timeSlots","className","children","onClick","disabled","title","window","confirm","onSubmit","value","onChange","target","type","required","placeholder","max","step","style","color","fontSize","handleDelete","userConfirmed","delete","_error$response","_error$response$data","map","time","r","backgroundColor","left","right"],"sources":["/app/frontend/src/App.js"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport \"./App.css\";\nimport axios from \"axios\";\n\n// ---------- API エンドポイント生成 ----------\nconst BACKEND_URL = (process.env.REACT_APP_BACKEND_URL || \"\").replace(/\\/+$/, \"\");\nconst API        = `${BACKEND_URL ? BACKEND_URL : \"\"}/api`;\nconst api        = axios.create({ baseURL: API });\n\n\n\nconst App = () => {\n  const [reservations, setReservations] = useState([]);\n  const [selectedDate, setSelectedDate] = useState(new Date().toISOString().split('T')[0]);\n  const [showCreateForm, setShowCreateForm] = useState(false);\n  const [editingReservation, setEditingReservation] = useState(null);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState('');\n\n  // Form state\n  const [formData, setFormData] = useState({\n    bench_id: 'front',\n    user_name: '',\n    start_time: '',\n    end_time: ''\n  });\n\n  // Load reservations for selected date with comprehensive error handling\n  const loadReservations = async (retryCount = 0, maxRetries = 3) => {\n    try {\n      console.log(`予約読み込み開始 (試行 ${retryCount + 1}/${maxRetries + 1}):`, selectedDate);\n      setLoading(true);\n      setError(''); // エラーをクリア\n      \n      // リクエスト設定の最適化\n      const requestConfig = {\n        params: { date: selectedDate },\n        timeout: 8000 + (retryCount * 2000), // 段階的にタイムアウトを延長\n        validateStatus: function (status) {\n          return status >= 200 && status < 300; // デフォルト\n        },\n        headers: {\n          'Accept': 'application/json',\n          'Content-Type': 'application/json'\n        }\n      };\n      \n      const response = await axios.get(`${API}/reservations`, requestConfig);\n      \n      // レスポンスデータの検証\n      if (!Array.isArray(response.data)) {\n        throw new Error('サーバーから無効なデータ形式が返されました');\n      }\n      \n      // データの妥当性チェック\n      const validReservations = response.data.filter(reservation => {\n        return reservation && \n               reservation.id && \n               reservation.bench_id && \n               reservation.user_name && \n               reservation.start_time && \n               reservation.end_time;\n      });\n      \n      if (validReservations.length !== response.data.length) {\n        console.warn(`無効な予約データを除外: ${response.data.length - validReservations.length}件`);\n      }\n      \n      console.log('予約データ取得成功:', validReservations);\n      setReservations(validReservations);\n      \n    } catch (err) {\n      console.error(`予約読み込みエラー (試行 ${retryCount + 1}):`, err);\n      \n      // エラー分類と自動リトライ判定\n      const isRetryableError = (\n        err.code === 'ECONNABORTED' || // タイムアウト\n        err.code === 'NETWORK_ERROR' || // ネットワークエラー\n        err.code === 'ERR_NETWORK' ||   // ネットワークエラー (axios)\n        (err.response && err.response.status >= 500) || // サーバーエラー\n        (err.response && err.response.status === 503) || // サービス利用不可\n        (err.response && err.response.status === 504)    // タイムアウト\n      );\n      \n      const shouldRetry = retryCount < maxRetries && isRetryableError;\n      \n      if (shouldRetry) {\n        const delay = Math.min(1000 * (2 ** retryCount), 8000); // 最大8秒\n        console.log(`${delay/1000}秒後に自動リトライします...`);\n        setError(`接続中です... (${retryCount + 1}回目再試行中)`);\n        \n        setTimeout(() => {\n          loadReservations(retryCount + 1, maxRetries);\n        }, delay);\n        \n      } else {\n        // 最大リトライ回数に達した場合またはリトライ不可エラー\n        let errorMessage = '予約の読み込みに失敗しました';\n        \n        if (err.response) {\n          // サーバーエラーレスポンスがある場合\n          errorMessage = err.response.data?.detail || \n                        `サーバーエラー (${err.response.status})`;\n        } else if (err.code === 'ECONNABORTED' || err.code === 'ERR_NETWORK') {\n          errorMessage = 'ネットワーク接続に問題があります';\n        } else if (err.message) {\n          errorMessage = err.message;\n        }\n        \n        setError(errorMessage);\n        console.error('最大リトライ回数に達しました:', err);\n      }\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  useEffect(() => {\n    loadReservations();\n  }, [selectedDate]);\n\n  // Create reservation\n  const createReservation = async (e) => {\n    e.preventDefault();\n    try {\n      setLoading(true);\n      setError('');\n      \n      const reservationData = {\n        ...formData,\n        start_time: `${selectedDate}T${formData.start_time}:00`,\n        end_time: `${selectedDate}T${formData.end_time}:00`\n      };\n      \n      await axios.post(`${API}/reservations`, reservationData);\n      \n      // Reset form and refresh\n      setFormData({ bench_id: 'front', user_name: '', start_time: '', end_time: '' });\n      setShowCreateForm(false);\n      await loadReservations();\n    } catch (err) {\n      setError(err.response?.data?.detail || '予約の作成に失敗しました');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  // Update reservation\n  const updateReservation = async (e) => {\n    e.preventDefault();\n    try {\n      setLoading(true);\n      setError('');\n      \n      const updateData = {\n        user_name: formData.user_name,\n        start_time: `${selectedDate}T${formData.start_time}:00`,\n        end_time: `${selectedDate}T${formData.end_time}:00`\n      };\n      \n      await axios.put(`${API}/reservations/${editingReservation.id}`, updateData);\n      \n      // Reset form and refresh\n      setFormData({ bench_id: 'front', user_name: '', start_time: '', end_time: '' });\n      setEditingReservation(null);\n      await loadReservations();\n    } catch (err) {\n      setError(err.response?.data?.detail || '予約の更新に失敗しました');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  // Start editing\n  const startEdit = (reservation) => {\n    const startTime = new Date(reservation.start_time).toTimeString().substring(0, 5);\n    const endTime = new Date(reservation.end_time).toTimeString().substring(0, 5);\n    \n    setFormData({\n      bench_id: reservation.bench_id,\n      user_name: reservation.user_name,\n      start_time: startTime,\n      end_time: endTime\n    });\n    setEditingReservation(reservation);\n    setShowCreateForm(false);\n  };\n\n  // Date navigation\n  const changeDate = (days) => {\n    const newDate = new Date(selectedDate);\n    newDate.setDate(newDate.getDate() + days);\n    setSelectedDate(newDate.toISOString().split('T')[0]);\n  };\n\n  // Format date for display\n  const formatDate = (dateString) => {\n    const date = new Date(dateString);\n    return date.toLocaleDateString('ja-JP', { \n      year: 'numeric', \n      month: 'long', \n      day: 'numeric',\n      weekday: 'long'\n    });\n  };\n\n  // Generate time slots for timetable (every 30 minutes, 7:00-22:00)\n  const generateTimeSlots = () => {\n    const slots = [];\n    for (let hour = 7; hour <= 22; hour++) {\n      for (let minute = 0; minute < 60; minute += 30) {\n        const timeString = `${hour.toString().padStart(2, '0')}:${minute.toString().padStart(2, '0')}`;\n        slots.push(timeString);\n      }\n    }\n    return slots;\n  };\n\n  // Calculate reservation bar properties\n  const calculateBarProperties = (reservation) => {\n    const startDate = new Date(reservation.start_time);\n    const endDate = new Date(reservation.end_time);\n    \n    const startMinutes = startDate.getHours() * 60 + startDate.getMinutes();\n    const endMinutes = endDate.getHours() * 60 + endDate.getMinutes();\n    const durationMinutes = endMinutes - startMinutes;\n    \n    // 7:00 (420分) を基準点として調整\n    const baseOffsetMinutes = 7 * 60; // 7:00 = 420分\n    const adjustedStartMinutes = startMinutes - baseOffsetMinutes;\n    \n    // Each 30-minute slot is 40px high\n    const pixelsPerMinute = 40 / 30;\n    const top = adjustedStartMinutes * pixelsPerMinute;\n    const height = durationMinutes * pixelsPerMinute;\n    \n    return { top, height };\n  };\n\n  // Get reservation color\n  const getReservationColor = (index) => {\n    const colors = [\n      '#667eea', '#764ba2', '#f093fb', '#f5576c',\n      '#4facfe', '#00f2fe', '#43e97b', '#38f9d7',\n      '#ffecd2', '#fcb69f', '#a8edea', '#fed6e3'\n    ];\n    return colors[index % colors.length];\n  };\n\n  // Auto cleanup old data function\n  const cleanupOldData = async () => {\n    try {\n      setLoading(true);\n      setError('');\n      \n      const response = await axios.post(`${API}/cleanup/old-data`, {}, {\n        timeout: 15000 // 15秒タイムアウト\n      });\n      \n      console.log('クリーンアップ完了:', response.data);\n      \n      // 成功メッセージを表示\n      if (response.data.deleted_count > 0) {\n        alert(`✅ ${response.data.deleted_count}件の古い予約データを削除しました`);\n      } else {\n        alert('ℹ️ 削除対象のデータはありませんでした');\n      }\n      \n      // 予約リストを更新\n      await loadReservations();\n      \n    } catch (err) {\n      console.error('クリーンアップエラー:', err);\n      const errorMessage = err.response?.data?.detail || 'データクリーンアップに失敗しました';\n      setError(`クリーンアップエラー: ${errorMessage}`);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const timeSlots = generateTimeSlots();\n\n  return (\n    <div className=\"app\">\n      <div className=\"container\">\n        <header className=\"header\">\n          <h1>クリーンベンチ予約システム</h1>\n          <p className=\"version-info\">バージョン 2.0 - 改善版</p>\n        </header>\n\n        {/* Date Navigation */}\n        <div className=\"date-navigation\">\n          <button onClick={() => changeDate(-1)} className=\"nav-button\">\n            ← 前日\n          </button>\n          <div className=\"current-date\">\n            {formatDate(selectedDate)}\n          </div>\n          <button onClick={() => changeDate(1)} className=\"nav-button\">\n            翌日 →\n          </button>\n        </div>\n\n        {/* Create Reservation Button & Manual Refresh & Cleanup */}\n        <div className=\"action-buttons\">\n          <button \n            onClick={() => {\n              setShowCreateForm(true);\n              setEditingReservation(null);\n              setFormData({ bench_id: 'front', user_name: '', start_time: '', end_time: '' });\n            }}\n            className=\"create-button\"\n          >\n            新規予約\n          </button>\n          \n          <button \n            onClick={() => {\n              console.log('手動更新ボタンがクリックされました');\n              loadReservations(0, 3); // 手動更新時も自動リトライ機能を使用\n            }}\n            className=\"refresh-button\"\n            disabled={loading}\n            title=\"予約一覧を手動で更新\"\n          >\n            {loading ? '🔄 更新中...' : '🔄 更新'}\n          </button>\n          \n          <button \n            onClick={() => {\n              if (window.confirm('30日より古い予約データを削除します。\\nこの操作は取り消せません。\\n実行しますか？')) {\n                cleanupOldData();\n              }\n            }}\n            className=\"cleanup-button\"\n            disabled={loading}\n            title=\"30日より古い予約データを削除してデータベース容量を節約\"\n          >\n            {loading ? '🧹 削除中...' : '🧹 古いデータ削除'}\n          </button>\n        </div>\n\n        {/* Error Message with Retry Option */}\n        {error && (\n          <div className=\"error-container\">\n            <div className=\"error-message\">\n              ⚠️ {error}\n            </div>\n            <button \n              onClick={() => {\n                setError('');\n                loadReservations(0, 3);\n              }}\n              className=\"retry-button\"\n              disabled={loading}\n            >\n              {loading ? '再試行中...' : '🔄 再試行'}\n            </button>\n          </div>\n        )}\n\n        {/* Create/Edit Form */}\n          {(showCreateForm || editingReservation) && (\n          <div className=\"form-container\">\n            <h3>{editingReservation ? '予約編集' : '新規予約'}</h3>\n            <form onSubmit={editingReservation ? updateReservation : createReservation}>\n              <div className=\"form-group\">\n                <label>ベンチ:</label>\n                <select \n                  value={formData.bench_id} \n                  onChange={(e) => setFormData({...formData, bench_id: e.target.value})}\n                  disabled={!!editingReservation}\n                >\n                  <option value=\"front\">手前</option>\n                  <option value=\"back\">奥</option>\n                </select>\n              </div>\n\n              <div className=\"form-group\">\n                <label>利用者名:</label>\n                <input\n                  type=\"text\"\n                  value={formData.user_name}\n                  onChange={(e) => setFormData({...formData, user_name: e.target.value})}\n                  required\n                  placeholder=\"お名前を入力してください\"\n                />\n              </div>\n\n              <div className=\"form-group\">\n                <label>開始時刻:</label>\n                <input\n                  type=\"time\"\n                  value={formData.start_time}\n                  onChange={(e) => setFormData({...formData, start_time: e.target.value})}\n                  min=\"07:00\"\n                  max=\"22:00\"\n                  step=\"1800\"\n                  required\n                />\n                <small style={{color: '#666', fontSize: '0.8rem'}}>\n                  利用可能時間: 7:00-22:00 (30分刻み)\n                </small>\n              </div>\n\n              <div className=\"form-group\">\n                <label>終了時刻:</label>\n                <input\n                  type=\"time\"\n                  value={formData.end_time}\n                  onChange={(e) => setFormData({...formData, end_time: e.target.value})}\n                  min=\"07:00\"\n                  max=\"22:00\"\n                  step=\"1800\"\n                  required\n                />\n                <small style={{color: '#666', fontSize: '0.8rem'}}>\n                  利用可能時間: 7:00-22:00 (30分刻み)\n                </small>\n              </div>\n\n              <div className=\"form-buttons\">\n                <button type=\"submit\" disabled={loading}>\n                  {editingReservation ? '更新' : '予約作成'}\n                </button>\n                \n                {editingReservation && (\n                  <button \n                    type=\"button\" \n                    className=\"delete-form-button\"\n                    disabled={loading}\n                    onClick={() => {\n                      console.log('削除ボタンがクリックされました');\n                      console.log('編集中の予約:', editingReservation);\n                      \n                      const handleDelete = async () => {\n                        try {\n                          // 詳細な確認ダイアログ\n                          const userConfirmed = window.confirm(\n                            `⚠️ 予約を削除してもよろしいですか？\\n\\n` +\n                            `📝 利用者: ${editingReservation.user_name}\\n` +\n                            `⏰ 時間: ${new Date(editingReservation.start_time).toTimeString().substring(0,5)} - ${new Date(editingReservation.end_time).toTimeString().substring(0,5)}\\n` +\n                            `🏢 ベンチ: ${editingReservation.bench_id === 'front' ? '手前' : '奥'}\\n\\n` +\n                            `❌ この操作は取り消せません。\\n\\n` +\n                            `削除する場合は「OK」を押してください。`\n                          );\n                          \n                          if (!userConfirmed) {\n                            console.log('ユーザーが削除をキャンセルしました');\n                            return;\n                          }\n                          \n                          console.log('削除処理を開始します...');\n                          console.log('削除対象ID:', editingReservation.id);\n                          \n                          setLoading(true);\n                          setError('');\n                          \n                          // DELETE リクエスト送信\n                          const response = await axios.delete(`${API}/reservations/${editingReservation.id}`);\n                          console.log('✅ 削除成功:', response.data);\n                          \n                          // 状態をリセット\n                          setEditingReservation(null);\n                          setFormData({ bench_id: 'front', user_name: '', start_time: '', end_time: '' });\n                          \n                          // 予約リストを再読み込み\n                          await loadReservations();\n                          console.log('✅ 削除処理が完了しました');\n                          \n                        } catch (error) {\n                          console.error('❌ 削除エラー:', error);\n                          if (error.response) {\n                            console.error('レスポンスエラー:', error.response.data);\n                            console.error('ステータスコード:', error.response.status);\n                          }\n                          setError(`削除に失敗しました: ${error.response?.data?.detail || error.message}`);\n                        } finally {\n                          setLoading(false);\n                        }\n                      };\n                      \n                      handleDelete();\n                    }}\n                  >\n                    {loading ? '削除中...' : '🗑️ 予約削除'}\n                  </button>\n                )}\n                \n                <button \n                  type=\"button\" \n                  onClick={() => {\n                    setShowCreateForm(false);\n                    setEditingReservation(null);\n                    setError('');\n                  }}\n                >\n                  キャンセル\n                </button>\n              </div>\n            </form>\n          </div>\n        )}\n\n        {/* Timetable View */}\n        <div className=\"timetable-container\">\n          {loading && <div className=\"loading\">読み込み中...</div>}\n          \n          <div className=\"timetable\">\n            {/* Header */}\n            <div className=\"timetable-header\">\n              <div className=\"time-column-header\">時刻</div>\n              <div className=\"bench-column-header\">手前</div>\n              <div className=\"bench-column-header\">奥</div>\n            </div>\n\n            {/* Time grid */}\n            <div className=\"timetable-grid\">\n              {/* Time column */}\n              <div className=\"time-column\">\n                {timeSlots.map((time, index) => (\n                  <div key={time} className=\"time-slot\">\n                    {time}\n                  </div>\n                ))}\n              </div>\n\n              {/* Front bench column */}\n              <div className=\"bench-column\" data-bench=\"front\">\n                <div className=\"bench-timeline\">\n                  {reservations\n                    .filter(r => r.bench_id === 'front')\n                    .map((reservation, index) => {\n                      const { top, height } = calculateBarProperties(reservation);\n                      return (\n                        <div\n                          key={reservation.id}\n                          className=\"reservation-bar\"\n                          style={{\n                            top: `${top}px`,\n                            height: `${height}px`,\n                            backgroundColor: getReservationColor(index),\n                            left: '2px',\n                            right: '2px'\n                          }}\n                          onClick={() => startEdit(reservation)}\n                          title={`クリックして編集: ${reservation.user_name} (${new Date(reservation.start_time).toTimeString().substring(0,5)} - ${new Date(reservation.end_time).toTimeString().substring(0,5)})`}\n                        >\n                          <div className=\"reservation-content\">\n                            <div className=\"reservation-user\">{reservation.user_name}</div>\n                            <div className=\"reservation-time\">\n                              {new Date(reservation.start_time).toTimeString().substring(0,5)} - {new Date(reservation.end_time).toTimeString().substring(0,5)}\n                            </div>\n                          </div>\n                          <div className=\"edit-indicator\">\n                            編集\n                          </div>\n                        </div>\n                      );\n                    })}\n                </div>\n              </div>\n\n              {/* Back bench column */}\n              <div className=\"bench-column\" data-bench=\"back\">\n                <div className=\"bench-timeline\">\n                  {reservations\n                    .filter(r => r.bench_id === 'back')\n                    .map((reservation, index) => {\n                      const { top, height } = calculateBarProperties(reservation);\n                      return (\n                        <div\n                          key={reservation.id}\n                          className=\"reservation-bar\"\n                          style={{\n                            top: `${top}px`,\n                            height: `${height}px`,\n                            backgroundColor: getReservationColor(index + 6),\n                            left: '2px',\n                            right: '2px'\n                          }}\n                          onClick={() => startEdit(reservation)}\n                          title={`クリックして編集: ${reservation.user_name} (${new Date(reservation.start_time).toTimeString().substring(0,5)} - ${new Date(reservation.end_time).toTimeString().substring(0,5)})`}\n                        >\n                          <div className=\"reservation-content\">\n                            <div className=\"reservation-user\">{reservation.user_name}</div>\n                            <div className=\"reservation-time\">\n                              {new Date(reservation.start_time).toTimeString().substring(0,5)} - {new Date(reservation.end_time).toTimeString().substring(0,5)}\n                            </div>\n                          </div>\n                          <div className=\"edit-indicator\">\n                            編集\n                          </div>\n                        </div>\n                      );\n                    })}\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default App;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}